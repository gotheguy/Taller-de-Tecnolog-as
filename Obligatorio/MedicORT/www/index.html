<!doctype html>
<html>
<head>
    <title>MedicORT</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css" type="text/css">
    <link rel="stylesheet" href="img/images/jQuery-Mobile-Icon-Pack-master/dist/jqm-icon-pack-fa.css"/>
    <link rel="stylesheet" href="css/index.css" type="text/css">
    <script src="js/jquery-1.8.3.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDhfTvXeR1_KtzXelJWoMu64w9RaZ7bmE8" async defer></script>
    <script>
        $(document).ready(function(){
            $("div").html(function (i, html) {
                return html.replace(/&nbsp;/g, '');
            });

           $(':input').val('');
        });

        function getSession() {
            return sessionStorage.getItem("session");
        }

        function setSession(mailUser) {
            sessionStorage.setItem("session", mailUser);
        }

        function getDoctor(id) {
            return sessionStorage.getItem(id);
        }

         function setDoctor(id,nombreDoc,apellidoDoc) {
            sessionStorage.setItem(id,nombreDoc + ' ' + apellidoDoc);
        }      

        function getCalificacion() {
            return sessionStorage.getItem("calificacion");
        }

         function setCalificacion(user,doctor) {
            sessionStorage.setItem("calificacion",user + ' ' + doctor);
        }       

        function getCentroMedico(id) {
            return sessionStorage.getItem(id);
        }

        function setCentroMedico(id,centro) {
            sessionStorage.setItem(id,JSON.stringify(centro));
        }

        function loadingShow() {
            var interval = setInterval(function(){
                $.mobile.loading('show');
                clearInterval(interval);
            },1); 
        }

        function loadingHide() {
            var interval = setInterval(function(){
                $.mobile.loading('hide');
                clearInterval(interval);
            },1); 
        }

        function login(){
			loadingShow();
			$.ajax({
				data: {email: $('#usuarioLog').val(), password: $('#passwordLog').val()},
				type: "GET",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/login",
				success: function(data){
					loadingHide();
                    if(data.resultado_login) {
                       setSession(data.email);
                       window.location.replace("#main-menu");
                    }
				},
                error: function(data,jqXHR){
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(!data.resultado_login) {
                            $('#PopupLogin').popup();
                            $("#PopupLogin").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupLogin").popup("close");
                            });
                        }
                    } else {
                        $('#PopupGenLogin').popup();
                        $("#PopupGenLogin").popup("open");

                        $(".ui-ok-button").unbind("click").bind("click",function(){
                            $("#PopupGenLogin").popup("close");
                        });
                    }
                }
			});
        }
        
        function registrar() {
			loadingShow();
			$.ajax({
                data: {email: $('#emailReg').val(), password: $('#passwordReg').val(), nombre: $('#nombreReg').val(), apellido: $('#apellidoReg').val(),
                       documento: $('#documentoReg').val(), telefono: $('#telefonoReg').val()},
				type: "POST",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/registrar",
				success: function(data){
					loadingHide();
                    if(data.retorno = "OK") {
                        setSession(data.email);
                        window.location.replace("#main-menu");
                    }
				},
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupRegister').popup();
                            $("#PopupRegister").popup("open"); 

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupRegister").popup("close");
                            });
                        }
                    } else {
                        $('#PopupGenRegister').popup();
                        $("#PopupGenRegister").popup("open");

                        $(".ui-ok-button").unbind("click").bind("click",function(){
                            $("#PopupGenRegister").popup("close");
                        });
                    }
                }
			});
		}

		function getProfesionales(){
            loadingShow();
			$.ajax({
				type: "GET",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/getProfesionales",
				success: function(data){
                    loadingHide();
                    if(data.retorno = "OK") {
                    var items = []; 
                    $.each(data.profesionales, function(i,item) {
                        var aux = data.profesionales[i];
                            $('#listviewDoc').empty();
                            setDoctor(aux.id,aux.nombre,aux.apellido);
                            items.push('<li id="' + aux.id + '" class="info-doc-li"><a href="#info-doc-detalle" data-transition="slide" class="doclist-item">' +
                            '<img src="' + aux.foto + '" alt="Imagen doctor"><h3 id="' + aux.id + '" class="doclist-name">' +
                            aux.nombre + ' ' + aux.apellido + ' ' + '</h3><p class="doclist-specialty">' + aux.especialidad + '</p></a></li>');
                        });
                        $('#listviewDoc').append(items.join(''));
                        $('#listviewDoc').listview().listview('refresh');

                        $('#listviewDoc li').click(function(){
                            getDetalleProfesional(this.id);
                        });
                    }
                },
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenProfesionales').popup();
                            $("#PopupGenProfesionales").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenProfesionales").popup("close");
                            });
                        }
                    }
                }
            });
        }

		function getProfesionalesPorEspecialidad(){
            loadingShow();
			$.ajax({
                data: {especialidad: $('#doclist-esp').val()},
				type: "GET",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/getProfesionalesPorEspecialidad",
				success: function(data){
                    loadingHide();
                    if(data.retorno = "OK") {
                        if(data.profesionales.length > 0) {
                            $('#listviewDocEsp').empty();
                            var items = []; 
                            $.each(data.profesionales, function(i,item) {
                                var aux = data.profesionales[i];
                                    $('#listviewDocEsp').empty();
                                    setDoctor(aux.id,aux.nombre,aux.apellido);
                                    items.push('<li id="' + aux.id + '" class="info-doc-li"><a href="#info-doc-detalle" data-transition="slide" class="doclist-item">' +
                                    '<img src="' + aux.foto + '" alt="Imagen doctor"><h3 id="' + aux.id + '" class="doclist-name">' +
                                    aux.nombre + ' ' + aux.apellido + ' ' + '</h3><p class="doclist-specialty">' + aux.especialidad + '</p></a></li>');
                                });
                                $('#listviewDocEsp').append(items.join(''));
                                $('#listviewDocEsp').listview().listview('refresh');

                                $('#listviewDocEsp li').click(function(){
                                    getDetalleProfesional(this.id);
                                });
                            }
                        }
                },
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenEspecialidades').popup();
                            $("#PopupGenEspecialidades").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenEspecialidades").popup("close");
                            });
                        }
                    }
                }
            });
        }

		function getDetalleProfesional(idDoc){
            loadingShow();
            var doctor = splitDoctor(idDoc);
			$.ajax({
                data: {nombre: doctor[0], apellido: doctor[1]},
				type: "GET",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/getDetalleProfesional",
				success: function(data){
                    if(data.retorno = "OK") {
                        loadingHide();
                        var items = []; 
                        $(".card").html("");
                        items.push('<img src="' + data.profesional.foto + '" alt="Imagen doctor en detalle" class="card-img"><div class="container">' + 
                        '<h3 class="card-name">' + data.profesional.nombre + ' ' + data.profesional.apellido + 
                        '</h3><h6 class="card-title">' + data.profesional.titulo + '</h6><h5 class="card-prof">' + 
                        data.profesional.especialidad + ' - ' + data.profesional.centroMedico.nombre + '</h5>' + 
                        '<h3 class="card-punt">' + (Math.round(data.profesional.puntuacion * 100) / 100) + '</h3></div>');
                        $('.card').append(items.join(''));

                        $("#reservar-consulta").unbind("click").bind("click",function(){
                            fijarConsultaMedica(data.profesional.id,getSession(),data.profesional.nombre,data.profesional.apellido,data.profesional.centroMedico.nombre);  
                        });
                        
                        $("#agregar-favorito").unbind("click").bind("click",function(){
                            guardarFavoritos(data.profesional.id,data.profesional.nombre,data.profesional.apellido,data.profesional.especialidad,data.profesional.foto,data.profesional.centroMedico.nombre);
                        });

                        $("#calificar-consulta").unbind("click").bind("click",function(){
                            $('#PopupPuntaje').popup();
                            $('#PopupPuntaje').popup('open');
                                $("#ui-ok-button-calificar").unbind("click").bind("click",function(){
                                asignarPuntajeAProfesional(data.profesional.nombre,data.profesional.apellido);
                                $("#PopupPuntaje").popup("close");
                            });
                        });
                    }
                },
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenDetalle').popup();
                            $("#PopupGenDetalle").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenDetalle").popup("close");
                            });
                        }
                    }
                }
            });
        }

        function splitDoctor(idDoc) {
            var doctor = getDoctor(idDoc);
            var split = [];
            split = doctor.split(" ");
            return split;
        }

        function parseDate2(fechaHora) {
            var fecha = new Date(fechaHora);
            fecha = fecha.toLocaleDateString('en-GB', { hour: 'numeric', minute: 'numeric'});
            fecha = fecha.replace(',','');
            return fecha;
        }

        function fijarConsultaMedica(idDoc,emailUser,nombreDoc,apellidoDoc,nombreMed) {
			loadingShow();
            var fecha = $('#fechaRes').val() + ' ' + $('#horaRes').val();
            fecha = parseDate2(fecha);

			$.ajax({
                data: {email: emailUser, fechaHora: fecha, nombreProfesional: nombreDoc, apellidoProfesional: apellidoDoc, nombreCentroMedico: nombreMed},
				type: "POST",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/fijarConsultaMedica",
				success: function(data) {
                    loadingHide();
                    if(data.retorno = "OK") { 
                        $('#PopupConsulta').popup();
                        $("#PopupConsulta").popup("open");

                        $(".ui-ok-button").unbind("click").bind("click",function(){
                            $("#PopupConsulta").popup("close");
                        });      
                    }
				},
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenConsulta').popup();
                            $("#PopupGenConsulta").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenConsulta").popup("close");
                            });
                        }
                    }
                }
			});
        }   

        function asignarPuntajeAProfesional(nombreDoc,apellidoDoc) {
			loadingShow();
			$.ajax({
                data: {nombre: nombreDoc, apellido: apellidoDoc, puntaje: $('#doctorCal').val()},
				type: "POST",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/asignarPuntajeAProfesional",
				success: function(data){
                    loadingHide();
                    if(data.retorno = "OK") {
                        if($('#doctorCal').val() >= 0 && $('#doctorCal').val() <= 100) {
                            if(getCalificacion() != (getSession() + ' ' + nombreDoc + ' ' + apellidoDoc)) {
                                $('.card-punt').text((Math.round(data.nuevoPuntaje * 100) / 100));
                                setCalificacion(getSession(),nombreDoc + ' ' + apellidoDoc);
                            } else {
                                $('#PopupGenPuntajeRedo').popup();
                                $("#PopupGenPuntajeRedo").popup("open");

                                $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenPuntajeRedo").popup("close");
                                });
                            }
                        } else {
                            $('#PopupGenPuntajeVal').popup();
                            $("#PopupGenPuntajeVal").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenPuntajeVal").popup("close");
                            });
                        }
                    }
				},
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenPuntaje').popup();
                            $("#PopupGenPuntaje").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenPuntaje").popup("close");
                            });
                        }
                    }
                }
			});
        }

        function guardarFavoritos(idDoc,nombreDoc,apellidoDoc,especialidadDoc,fotoDoc,centroMed) {
            var db = window.openDatabase("favDB", "1.0", "FavoritosDB", 1024 * 1024 * 2)
            var user = getSession();

            db.transaction(function(tx) {
                tx.executeSql("CREATE TABLE IF NOT EXISTS FavoritosD (id INTEGER, nombre VARCHAR(100), apellido VARCHAR(100), especialidad VARCHAR(100), foto NVARCHAR(250), centroMedico NVARCHAR(200), usuario VARCHAR(100))"); 
            }); 

            db.transaction(function(tx) {
                tx.executeSql("INSERT INTO FavoritosD (id,nombre,apellido,especialidad,foto,centroMedico,usuario) VALUES (" + idDoc + ",'" + nombreDoc + "','" + apellidoDoc + "','" + especialidadDoc + "','" + fotoDoc + "','" + centroMed + "','" + user + "')");
            });

            $('#PopupFavoritos').popup();
            $("#PopupFavoritos").popup("open");

            $(".ui-ok-button").unbind("click").bind("click",function(){
                $("#PopupFavoritos").popup("close");
            });
        }

        function getFavoritos() {
            var db = window.openDatabase("favDB", "1.0", "FavoritosDB", 1024 * 1024 * 2)
            var items = [];

            db.transaction(function (tx) {
                tx.executeSql("SELECT DISTINCT * FROM FavoritosD", [], function(tx, results) {
                    if(results.rows.length > 0) {
                        for(var i = 0; i < results.rows.length; i++) {
                            var aux = results.rows.item(i);
                            $('#listviewFav').empty();

                            if(getSession() == aux.usuario) {
                                items.push('<li class="info-fav-li" data-icon="false"><a data-transition="slide" class="favlist-item">' +
                                '<img src="' + aux.foto + '" class="img-fav" alt="Imagen doctor"><h3 id="' + aux.id + '" class="favlist-name">' +
                                aux.nombre + ' ' + aux.apellido + ' ' + '</h3><p class="favlist-specialty">' + aux.especialidad + '</p>' +
                                '<p class="favlist-centro">' + aux.centroMedico + '</p></a></li>');
                            }
                        }
                        $('#listviewFav').append(items.join(''));
                        $('#listviewFav').listview().listview('refresh');
                    }
                });
            });
        }

		function getHistorialConsultasMedicas(){
            loadingShow();
			$.ajax({
                data: {email: getSession()},
				type: "GET",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/getHistorialConsultasMedicas",
				success: function(data){
                    loadingHide();
                    if(data.retorno = "OK") {
                    var items = []; 
                    $.each(data.consultasMedicas, function(i,item) {
                        var aux = data.consultasMedicas[i];
                            $('#listviewCon').empty();
                            items.push('<li data-role="list-divider">' + parseDate(aux.fechaHora) + '</li><li class="info-con-li conlist-item">' +
                            '<h3 class="conlist-number">#' + aux.id + ' - ' + 
                            aux.profesional.especialidad + '</h3><p class="conlist-med">' + aux.centroMedico.nombre + '</p><p class="conlist-dr">Dr/a. ' + 
                            aux.profesional.nombre + ' ' + aux.profesional.apellido + '</p></li>');
                            parseDate(aux.fechaHora);
                        });
                        $('#listviewCon').append(items.join(''));
                        $('#listviewCon').listview().listview('refresh');
                    }
                },
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenConsultas').popup();
                            $("#PopupGenConsultas").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenConsultas").popup("close");
                            });
                        }
                    }
                }
            });
        }     

        function parseDate(fechaHora) {
            var fecha = new Date(fechaHora);
            return fecha.toLocaleDateString('en-GB', { hour: 'numeric', minute: 'numeric'});
        }

		function getCentrosMedicos(){
            loadingShow();
			$.ajax({
				type: "GET",
				dataType: "json",
				url: "http://medicort.tribus.com.uy/getCentrosMedicos",
				success: function(data){
                    loadingHide();
                    if(data.retorno = "OK") {
                    var items = []; 
                    $.each(data.centrosMedicos, function(i,item) {
                        var aux = data.centrosMedicos[i];
                            $('#listviewMed').empty();
                            setCentroMedico(aux.id,aux);
                            items.push('<li id="' + aux.id + '" class="info-med-li"><a href="#info-med-detalle" data-transition="slide" class="medlist-item">' +
                            '<h3 class="medlist-name">' + aux.nombre + '</h3><p class="medlist-adress">' + aux.direccion + '</p></a></li>');
                        });
                        $('#listviewMed').append(items.join(''));
                        $('#listviewMed').listview().listview('refresh');

                        $('#listviewMed li').click(function(){
                            var obj = JSON.parse(getCentroMedico(this.id));
                            initMap(obj.localizacion.latitud,obj.localizacion.longitud);
                        });
                    }
                },
                error: function(data,jqXHR) {
                    loadingHide();
                    if(jqXHR.status = 500) {
                        if(data.retorno = "ERROR") {
                            $('#PopupGenCentrosMedicos').popup();
                            $("#PopupGenCentrosMedicos").popup("open");

                            $(".ui-ok-button").unbind("click").bind("click",function(){
                                $("#PopupGenCentrosMedicos").popup("close");
                            });
                        }
                    }
                }
            });
        }

    function initMap(latMed,longMed) {
        var directionsDisplay = new google.maps.DirectionsRenderer;
        var directionsService = new google.maps.DirectionsService;
        var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 14,
        center: {lat: parseFloat(latMed), lng: parseFloat(longMed)}
        });
        directionsDisplay.setMap(map);
        calculateAndDisplayRoute(directionsService, directionsDisplay, latMed, longMed);
      }

      function calculateAndDisplayRoute(directionsService, directionsDisplay, latMed, longMed) {
        var selectedMode = "DRIVING";
            if ("geolocation" in navigator){
            navigator.geolocation.getCurrentPosition(function getPosition(position){ 
                directionsService.route({
                origin: {lat: position.coords.latitude, lng: position.coords.longitude},
                destination: {lat: parseFloat(latMed), lng: parseFloat(longMed)},
                travelMode: google.maps.TravelMode[selectedMode]
            }, function(response, status) {
                if (status == 'OK') {
                directionsDisplay.setDirections(response);
                } else {
                window.alert('No se han encontrado las direcciones indicadas');
                }
                });
            });
        } else {
            alert("No hemos podido encontrar tu ubicación");
        }
    }
    </script>
</head>
<body>
    <div data-role="page" id="start-menu">
        <div data-role="header">
            <img class="appLogo" src="img/images/heartbeat.png" alt="logo"> 
        </div>
        
        <div role="main" class = "ui-content">
            <h2>Bienvenido!</h2>
            <p>Ya estoy registrado</p>
            <a href="#login" data-transition="slide" class="ui-btn ui-btn-b ui-corner-all">Ingresar</a>
            <p>Aún no tienes una cuenta?</p>
            <a href="#register" data-transition="slide" class="ui-btn ui-btn-b ui-corner-all">Registrarme</a>
            <p></p>
        </div>
        
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="login">
        <div data-role="header">
        <a href="#start-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
        class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all main-back-link"></a>
        <img class="appLogo" src="img/images/heartbeat.png" alt="logo"> 
        </div>
        
        <div role="main" class="ui-content">
        <form id="formLogin" autocomplete="off">
                <fieldset data-role="fieldcontain">
                <label class="registerInput" for="usuarioLog">Email</label>
                <input type="text" name="usuario" id="usuarioLog">
                </fieldset>
                <fieldset data-role="fieldcontain">
                <label class="registerInput" for="passwordLog">Contraseña</label>
                <input type="password" name="password" id="passwordLog">
                </fieldset>
            <div class="button">
                <a href="" class="ui-btn ui-btn-b ui-corner-all" onclick="login()">Ingresar</a>
            </div>
        </form>
        <div data-role="popup" id="PopupLogin" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
            <div data-role="header" data-theme="a">
                <h1>¡Upsss!</h1>
            </div>
            <div role="main" class="ui-content popup-text">
                <h3 class="ui-title">Tu email y/o contraseña son incorrectos</h3>
                    <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                <div data-role="popup" id="PopupGenLogin" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                            <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
            </div>
        </div>
        </div>
            <div data-role="footer" data-position="fixed">
                <h4></h4>
            </div>
        </div>

    <div data-role="page" id="register">
        <div data-role="header">
            <a href="#start-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
            class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all main-back-link"></a>
            <img class="appLogo" src="img/images/heartbeat.png" alt="logo"> 
        </div>
        
        <div role="main" class="ui-content">
            <form id="formRegister" autocomplete="off">
                <fieldset data-role="fieldcontain">
                    <label class="registerInput" for="nombreReg">Nombre</label>
                    <input type="text" name="nombre" id="nombreReg">
                </fieldset>
                <fieldset data-role="fieldcontain">
                    <label class="registerInput" for="apellidoReg">Apellido</label>
                    <input type="text" name="apellido" id="apellidoReg">
                </fieldset>
                <fieldset data-role="fieldcontain">
                    <label class="registerInput" for="passwordReg">Contraseña</label>
                    <input type="password" name="password" id="passwordReg">
                </fieldset>
                <fieldset data-role="fieldcontain">
                    <label class="registerInput" for="emailReg">Email</label>
                    <input type="email" name="email" id="emailReg">
                </fieldset>
                <fieldset class="ui-grid-a sideByside">
                    <div class="ui-block-a">
                        <label class="registerInput" for="documentoReg">Documento</label>
                        <input type="text" name="documento" id="documentoReg">
                    </div>
                    <div class="ui-block-b">
                        <label class="registerInput" for="telefonoReg">Teléfono</label>
                        <input type="text" name="telefono" id="telefonoReg">
                    </div>
                </fieldset>
                <div class="button">
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all" onclick="registrar()">Crear cuenta</a>
                </div>
            </form>
        <div data-role="popup" id="PopupRegister" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                <div data-role="header" data-theme="a">
                    <h1>¡Upsss!</h1>
                </div>
                <div role="main" class="ui-content popup-text">
                    <h3 class="ui-title">Ya existe un usuario con ese email o teléfono</h3>
                        <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                </div>
            </div>
            <div data-role="popup" id="PopupGenRegister" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                <div data-role="header" data-theme="a">
                    <h1>¡Upsss!</h1>
                </div>
                <div role="main" class="ui-content popup-text">
                    <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                        <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                </div>
            </div>
        </div>
            <div data-role="footer" data-position="fixed">
                <h4></h4>
            </div>
        </div>

    <div data-role="page" id="main-menu">
        <div data-role="header">
            <h1 class="ui-title-page">Menú</h1>
        </div>

        <div role="main" class="ui-content">
            <ul data-role="listview">
                <li><a href="#info-doc" data-transition="slide" class="main-menu-item" onclick="getProfesionales()">Buscar profesionales</a></li>
                <li><a href="#info-doc-esp" data-transition="slide" class="main-menu-item">Buscar por especialidad</a></li>
                <li><a href="#consultas-med" data-transition="slide" class="main-menu-item" onclick="getHistorialConsultasMedicas()">Mis consultas</a></li>
                <li><a href="#centro-med" data-transition="slide" class="main-menu-item" onclick="getCentrosMedicos()">Centros médicos</a></li>
                <li><a href="#favoritos-med" data-transition="slide" class="main-menu-item" onclick="getFavoritos()">Favoritos</a></li>
                <li><a href="#start-menu" data-transition="slide" data-direction="reverse" class="main-menu-item">Cerrar sesión</a></li>
            </ul>
        </div>
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="info-doc">
        <div data-role="header">
            <a href="#main-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
            class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
            <h1 class="ui-title-page">Profesionales</h1>
        </div>

        <div role="main" class="ui-content doclist">
            <form class="ui-filterable">
                <input id="filter-doclist" data-type="search" placeholder="Buscar..">
            </form>

            <ul id="listviewDoc" data-role="listview" data-inset="true" data-filter="true" data-input="#filter-doclist">
            </ul>
            <div data-role="popup" id="PopupGenProfesionales" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                <div data-role="header" data-theme="a">
                    <h1>¡Upsss!</h1>
                </div>
                <div role="main" class="ui-content popup-text">
                    <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                        <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                </div>
            </div>
        </div>
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="info-doc-esp">
        <div data-role="header">
            <a href="#main-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
            class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
            <h1 class="ui-title-page">Especialidades</h1>
        </div>

        <div role="main" class="ui-content doclist">
            <input id="doclist-esp" data-type="search" placeholder="Buscar..">
            <div class="button" id="esp-button">
                    <a href="#" data-role="button" class="ui-btn ui-btn-b ui-corner-all" onclick="getProfesionalesPorEspecialidad()">Buscar</a>
                </div>
            <ul id="listviewDocEsp" data-role="listview" data-inset="true">
            </ul>

            <div data-role="popup" id="PopupGenEspecialidades" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                <div data-role="header" data-theme="a">
                    <h1>¡Upsss!</h1>
                </div>
                <div role="main" class="ui-content popup-text">
                    <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                        <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                </div>
            </div>
        </div>
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="info-doc-detalle">
            <div data-role="header">
                <a href="#info-doc" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
                class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
                <h1 class="ui-title-page">Detalle de profesional</h1>
            </div>

            <div role="main" class="ui-content doclist">
                <div class="card">
                </div>
                <div data-role="popup" id="PopupGenDetalle" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                            <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
            </div>     
            <div data-role="footer" data-position="fixed">
                <div data-role="navbar">
                    <ul id="footerOptions">
                        <li><a href="#doc-consulta" data-role="button" data-icon="calendar" data-transition="slideup"
                        class="doclist-option inlineIcon"><span class="doclist-option-text">Agendar</span></a></li>
                        <li><a id="agregar-favorito" data-role="button" data-icon="heart" data-transition="slideup"
                        class="doclist-option inlineIcon"><span class="doclist-option-text">Favorito</span></a></li>
                        <li><a id="calificar-consulta" data-role="button" data-icon="star" data-transition="slideup"
                        class="doclist-option inlineIcon"><span class="doclist-option-text">Calificar</span></a></li>
                    </ul>
                </div>
                <div data-role="popup" id="PopupPuntaje" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <a href="#" class="ui-link ui-btn ui-icon-delete ui-btn-icon-right ui-shadow ui-corner-all" onclick="$('#PopupPuntaje').popup('close')"></a>
                        <h1>¡Yeyyy!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Por favor, ingresa calificación para tu doctor</h3>
                        <input type="number" name="doctorcal" id="doctorCal">
                        <a href="#" id="ui-ok-button-calificar" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
                <div data-role="popup" id="PopupGenPuntaje" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                            <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
                <div data-role="popup" id="PopupGenPuntajeVal" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">El puntaje debe ser entre 0 y 100</h3>
                            <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
                <div data-role="popup" id="PopupGenPuntajeRedo" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Ya has calificado a este profesional</h3>
                            <p class="ui-subtitle">¡Gracias!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
            </div>
        </div>

        <div data-role="page" id="doc-consulta">
            <div data-role="header">
                <a href="#info-doc-detalle" data-transition="slideup" data-direction="reverse" data-icon="arrow-left"
                class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
                <h1 class="ui-title-page">Agendar consulta</h1>
            </div>

            <div role="main" class="ui-content">
                <form id="formRes" autocomplete="off">
                    <fieldset data-role="fieldcontain">
                    <label class="ReservaInput" for="fechaRes">Fecha</label>
                    <input type="date" name="fecha" id="fechaRes">
                    </fieldset>
                    <fieldset data-role="fieldcontain">
                    <label class="ReservaInput" for="horaRes">Hora</label>
                    <input type="time" name="hora" id="horaRes">
                    </fieldset>  
                    <div id="btnRes">           
                        <a href="#" id="reservar-consulta" class="ui-btn ui-btn-b ui-corner-all">Reservar</a>
                    </div> 
                </form>
                <div data-role="popup" id="PopupConsulta" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Yeyyy!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Has fijado tu consulta con el doctor</h3>
                            <p class="ui-subtitle">¡Gracias!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
                <div data-role="popup" id="PopupGenConsulta" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                            <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
            </div>
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="consultas-med">
        <div data-role="header">
            <a href="#main-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
            class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
            <h1 class="ui-title-page">Mis consultas</h1>
        </div>

        <div role="main" class="ui-content conlist">
            <ul id="listviewCon" data-role="listview" data-inset="true">
            </ul>
            <div data-role="popup" id="PopupGenConsultas" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                <div data-role="header" data-theme="a">
                    <h1>¡Upsss!</h1>
                </div>
                <div role="main" class="ui-content popup-text">
                    <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                        <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                </div>
            </div>
        </div>
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

        <div data-role="page" id="centro-med">
            <div data-role="header">
                <a href="#main-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
                class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
                <h1 class="ui-title-page">Centros médicos</h1>
            </div>

            <div role="main" class="ui-content medlist">
                <form class="ui-filterable">
                    <input id="filter-medlist" data-type="search" placeholder="Buscar..">
                </form>
                <ul id="listviewMed" data-role="listview" data-inset="true" data-filter="true" data-input="#filter-medlist">
                </ul>
                <div data-role="popup" id="PopupGenCentrosMedicos" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                    <div data-role="header" data-theme="a">
                        <h1>¡Upsss!</h1>
                    </div>
                    <div role="main" class="ui-content popup-text">
                        <h3 class="ui-title">Mmmh.. Parece que ha ocurrido un error</h3>
                            <p class="ui-subtitle">¡Vuelve a intentarlo!</p>
                        <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                    </div>
                </div>
            </div>  
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="favoritos-med">
        <div data-role="header">
            <a href="#main-menu" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
            class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
            <h1 class="ui-title-page">Favoritos</h1>
        </div>

        <div role="main" class="ui-content favlist">
            <ul id="listviewFav" data-role="listview" data-inset="true">
            </ul>
            <div data-role="popup" id="PopupFavoritos" class="Popup" data-overlay-theme="a" data-theme="a" data-dismissible="true" data-transition="slideup">
                <div data-role="header" data-theme="a" class="ui-header ui-bar-a">
                    <h1 class="ui-title">¡Yeyyy!</h1>
                </div>
                <div role="main" class="ui-content popup-text">
                    <h3 class="ui-title">Has guardado a tu doctor como favorito</h3>
                        <p class="ui-subtitle">¡Gracias!</p>
                    <a href="#" class="ui-btn ui-btn-b ui-corner-all ui-ok-button" data-transition="slideup">OK</a>
                </div>
            </div>
        </div>
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>

    <div data-role="page" id="info-med-detalle">
        <div data-role="header">
            <a href="#centro-med" data-transition="slide" data-direction="reverse" data-icon="arrow-left"
            class="ui-link ui-btn ui-icon-arrow-left ui-btn-icon-left ui-shadow ui-corner-all"></a>
            <h1 class="ui-title-page">Detalle de Centro</h1>
        </div>

        <div role="main" class="ui-content medlist-detalle">
            <div id="map"></div>
        </div>  
        <div data-role="footer" data-position="fixed">
            <h4></h4>
        </div>
    </div>
</body>
</html>